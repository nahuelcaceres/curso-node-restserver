(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){"use strict";n.r(t);var s,c=n(1),a=n.n(c),r=n(69),o=n.n(r),i=(n(78),n(4)),j=n(27),l=n(2),u=n(25),b=n.n(u),m=n(0),d=function(e){var t=e.usuarios;return Object(m.jsxs)("div",{children:[Object(m.jsx)("h3",{children:"Usuarios"}),Object(m.jsx)("hr",{}),Object(m.jsx)("ul",{id:"ulUsuarios",children:t.map((function(e,t){return Object(m.jsx)("li",{children:e.name},t)}))})]})},h=function(){return sessionStorage.getItem("token")||null},O=function(e,t){sessionStorage.setItem("token",e),sessionStorage.setItem("user",t)},x=function(){sessionStorage.removeItem("token"),sessionStorage.removeItem("user")},f=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),s=n[0],a=n[1];return Object(c.useEffect)((function(){var e=b()("http://localhost:8080",{transports:["websocket"],auth:{"x-token":h()}});return e.on("usuarios-activos",(function(e){console.log({data:e}),a(e)})),function(){e.disconnect()}}),[]),Object(m.jsxs)("div",{className:"container",children:[Object(m.jsxs)("div",{className:"row mt-5",children:[Object(m.jsxs)("div",{className:"col-sm-6",children:[Object(m.jsx)("h3",{children:"Enviar mensaje"}),Object(m.jsx)("hr",{}),Object(m.jsx)("input",{type:"text",id:"txtUid",className:"form-control mb-2",placeholder:"uid",autoComplete:"off"}),Object(m.jsx)("input",{type:"text",id:"txtMensaje",className:"form-control mb-2",placeholder:"Mensaje",autoComplete:"off"}),Object(m.jsx)(d,{usuarios:s})]}),Object(m.jsxs)("div",{className:"col-sm-6",children:[Object(m.jsx)("h3",{children:"Chat completo"}),Object(m.jsx)("hr",{}),Object(m.jsx)("ul",{id:"ulMensajes"})]}),Object(m.jsxs)("div",{className:"col-sm-6",children:[Object(m.jsx)("h3",{children:"Chat privado"}),Object(m.jsx)("hr",{}),Object(m.jsx)("ul",{id:"ulMensajesPrivados"})]})]}),Object(m.jsx)("input",{type:"button",value:"Logout"})]})},p=function(){return Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{className:"text-center",children:"Web chat application"}),Object(m.jsx)("a",{className:"text-center",href:"https://www.linkedin.com/in/nahuel-caceres/",children:"by Nahuel Caceres"})]})},g=function(e){var t=Object(c.useState)("test1@gmail.com"),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)("123456"),o=Object(i.a)(r,2),j=o[0],l=o[1],u=Object(c.useState)(null),b=Object(i.a)(u,2),d=b[0],h=b[1],x=Object(c.useState)(!1),f=Object(i.a)(x,2),p=f[0],g=f[1],v=function(){if(""!==s&&""!==j){if(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s)){g(!0);var t={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:s,password:j}),redirect:"follow"};fetch("/api/auth/login",t).then((function(e){return e.json()})).then((function(t){return t.errors?(h(t.errors[0].msg),void g(!1)):t.msg?(h(t.msg),void g(!1)):(O(t.token,JSON.stringify(t.user)),e.history.push("/join"),void g(!1))})).catch((function(e){g(!1),h("Something went wrong. Please try again later.")}))}else h("Invalid Email Address")}else h("Completar campos")};return Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{className:"text-center",children:"Login"}),Object(m.jsxs)("form",{children:[Object(m.jsx)("div",{className:"mb-3",children:Object(m.jsx)("input",{value:s,onChange:function(e){return a(e.target.value)},type:"email",placeholder:"email",className:"form-control"})}),Object(m.jsx)("div",{className:"mb-3",children:Object(m.jsx)("input",{value:j,onChange:function(e){return l(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?v():null},type:"password",placeholder:"password",className:"form-control"})}),d&&Object(m.jsx)("div",{className:"error",children:d}),Object(m.jsx)("input",{className:"btn btn-primary",type:"button",value:p?"Loading...":"Login",disabled:p,onClick:v}),Object(m.jsx)("input",{className:"btn btn-secondary registerButton",type:"button",value:p?"Loading...":"Register",disabled:p,onClick:function(){}})]})]})},v=(n(107),function(e){var t=Object(c.useState)(""),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)([]),o=Object(i.a)(r,2),j=o[0],l=o[1];Object(c.useEffect)((function(){fetch("api/users/rooms").then((function(e){return e.json()})).then((function(e){return l(e.rooms)}))}),[]);return Object(m.jsx)("div",{className:"joinOuterContainer",children:Object(m.jsxs)("div",{className:"joinInnerContainer",children:[Object(m.jsx)("h1",{className:"heading",children:"Choose a room"}),j.length>0&&Object(m.jsx)("div",{children:Object(m.jsx)("select",{className:"form-select","aria-label":"Default select example",children:j.map((function(e){return Object(m.jsx)("option",{value:e,children:e},e)}))})}),Object(m.jsx)("div",{children:Object(m.jsx)("input",{placeholder:"Create one",onChange:function(e){return a(e.target.value)},onKeyPress:function(t){return"Enter"===t.key?void e.history.push("/chat?room=".concat(s)):null},className:"joinInput mt-20",type:"text"})})]})})}),A=n(15),N=n(26),C=function(e){var t=e.component,n=Object(N.a)(e,["component"]);return Object(m.jsx)(l.b,Object(A.a)(Object(A.a)({},n),{},{render:function(e){return h()?Object(m.jsx)(t,Object(A.a)({},e)):Object(m.jsx)(l.a,{to:{pathName:"/login",state:{from:e.location}}})}}))},y=function(e){var t=e.component,n=Object(N.a)(e,["component"]);return Object(m.jsx)(l.b,Object(A.a)(Object(A.a)({},n),{},{render:function(e){return h()?Object(m.jsx)(l.a,{to:{pathName:"/dashboard"}}):Object(m.jsx)(t,Object(A.a)({},e))}}))},S=n(73),I=n(71),k=n.n(I),w="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAAXNSR0IArs4c6QAAAExJREFUCB1jbPh/le3lx5tNDIwMcQwg8J9hkTi/eh0LWJCBoRwoAAPlQDEGJrhKmDCIBupmQuYjs5lAZiILgNlAMRaQRSAz4UZCLQcAIwYaiAejKoYAAAAASUVORK5CYII=",E=(n(123),function(e){var t=e.room;return Object(m.jsxs)("div",{className:"infoBar",children:[Object(m.jsxs)("div",{className:"leftInnerContainer",children:[Object(m.jsx)("img",{className:"onlineIcon",src:w,alt:"online icon"}),Object(m.jsxs)("h3",{children:["Room: ",t]})]}),Object(m.jsx)("div",{className:"rightInnerContainer",children:Object(m.jsx)("a",{href:"/",children:Object(m.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAHBJREFUGBmNkAEKwCAMA2VfGP2mrx3sOV2us6IymIXQGlNTW9zdhCqcZQm4dmelFUp+CZZa6sYpeUVIFyIixMqjCO51Wy5unQExuYSbSF5JASLqPsqRM21lOoWc89tagr3PSMgOiWlwnUeXWA/E78IfuAX270S3ydAAAAAASUVORK5CYII=",alt:"close icon",onClick:function(){console.log("Deberia ver esto antes de ir a home"),x()}})})})]})}),M=(n(124),function(e){var t=e.message,n=e.setMessage,s=e.sendMessage;return Object(m.jsxs)("form",{className:"form",children:[Object(m.jsx)("input",{className:"input",type:"text",placeholder:"Type a message...",value:t,onChange:function(e){var t=e.target.value;return n(t)},onKeyPress:function(e){return"Enter"===e.key?s(e):null}}),Object(m.jsx)("button",{className:"sendButton",onClick:function(e){return s(e)},children:"Send"})]})}),R=n(72),U=n.n(R),B=(n(146),n(42)),L=n.n(B),P=function(e){var t=e.message,n=t.user,s=t.text,c=!1,a=e.name.trim().toLowerCase();return n===a&&(c=!0),c?Object(m.jsxs)("div",{className:"messageContainer justifyEnd",children:[Object(m.jsx)("p",{className:"sentText pr-10",children:a}),Object(m.jsx)("div",{className:"messageBox backgroundBlue",children:Object(m.jsx)("p",{className:"messageText colorWhite",children:L.a.emojify(s)})})]}):Object(m.jsxs)("div",{className:"messageContainer justifyStart",children:[Object(m.jsx)("div",{className:"messageBox backgroundLight",children:Object(m.jsx)("p",{className:"messageText colorDark",children:L.a.emojify(s)})}),Object(m.jsx)("p",{className:"sentText pl-10 ",children:n})]})},J=(n(147),function(e){var t=e.messages,n=e.name;return Object(m.jsx)(U.a,{className:"messages",children:t.map((function(e,t){return Object(m.jsx)("div",{children:Object(m.jsx)(P,{message:e,name:n})},t)}))})}),K=(n(148),function(e){var t=e.users;return Object(m.jsxs)("div",{className:"textContainer",children:[Object(m.jsxs)("div",{children:[Object(m.jsxs)("h1",{children:["Realtime Chat Application ",Object(m.jsx)("span",{role:"img","aria-label":"emoji",children:"\ud83d\udcac"})]}),Object(m.jsxs)("h2",{children:["Created with React, Express, Node and Socket.IO ",Object(m.jsx)("span",{role:"img","aria-label":"emoji",children:"\u2764\ufe0f"})]}),Object(m.jsxs)("h2",{children:["Try it out right now! ",Object(m.jsx)("span",{role:"img","aria-label":"emoji",children:"\u2b05\ufe0f"})]})]}),t?Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:"People currently chatting:"}),Object(m.jsx)("div",{className:"activeContainer",children:Object(m.jsx)("h2",{children:t.map((function(e){var t=e.name;return Object(m.jsxs)("div",{className:"activeItem",children:[t,Object(m.jsx)("img",{alt:"Online Icon",src:w})]},t)}))})})]}):null]})}),T=(n(149),function(e){var t=e.location,n=Object(c.useState)(""),a=Object(i.a)(n,2),r=a[0],o=a[1],j=Object(c.useState)(""),l=Object(i.a)(j,2),u=l[0],d=l[1],O=Object(c.useState)([]),f=Object(i.a)(O,2),p=f[0],g=f[1],v=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}(),A=k.a.parse(t.search).room,N="https://chat-nmc.herokuapp.com/";Object(c.useEffect)((function(){return s=b()(N,{transports:["websocket","hola viejo"],auth:{"x-token":h(),data:{uid:v.uid,room:A}}}),function(){x(),s.emit("disconnect_"),s.off()}}),[N,t.search]),Object(c.useEffect)((function(){setTimeout((function(){s.emit("join",{uid:v.uid,room:A},(function(e){e&&alert(e)}))}),1e3)}),[]),Object(c.useEffect)((function(){s.on("message",(function(e){g([].concat(Object(S.a)(p),[e]))})),s.on("roomData",(function(e){var t=e.users;console.log("on roomData"),console.log({users:t}),d(t)}))}),[p]);return Object(m.jsxs)("div",{className:"outerContainer",children:[Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)(E,{room:A}),Object(m.jsx)(J,{messages:p,name:v.name}),Object(m.jsx)(M,{message:r,setMessage:o,sendMessage:function(e){e.preventDefault(),r&&s.emit("sendMessage",r,(function(){return o("")}))}})]}),Object(m.jsx)(K,{users:u})]})});var D=function(){var e=Object(c.useState)(!0),t=Object(i.a)(e,2),n=t[0],s=t[1];return Object(c.useEffect)((function(){var e=h();e&&fetch("/api/auth/verifyToken?token=".concat(e)).then((function(e){return e.json()})).then((function(e){O(e.token,e.user),s(!1)})).catch((function(e){x(),s(!1)}))}),[]),n&&h()?Object(m.jsx)("div",{className:"content",children:"Checking Authentication..."}):Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(j.a,{children:[Object(m.jsxs)("div",{className:"header",children:[Object(m.jsx)(j.b,{exact:!0,activeClassName:"active",to:"/",children:"Home"}),Object(m.jsx)(j.b,{activeClassName:"active",to:"/login",children:"Login"})]}),Object(m.jsx)("div",{className:"content",children:Object(m.jsxs)(l.d,{children:[Object(m.jsx)(l.b,{exact:!0,path:"/",component:p}),Object(m.jsx)(y,{exact:!0,path:"/login",component:g}),Object(m.jsx)(C,{exact:!0,path:"/join",component:v}),Object(m.jsx)(C,{exact:!0,path:"/chat",component:T}),Object(m.jsx)(C,{exact:!0,path:"/dashboard",component:f})]})})]})})};o.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(D,{})}),document.getElementById("root"))},78:function(e,t,n){}},[[150,1,2]]]);
//# sourceMappingURL=main.b79b4755.chunk.js.map