(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var c,s=n(1),a=n.n(s),o=n(69),r=n.n(o),i=(n(78),n(4)),j=n(15),l=n(2),u=n(26),b=n.n(u),d=n(0),m=function(e){var t=e.usuarios;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h3",{children:"Usuarios"}),Object(d.jsx)("hr",{}),Object(d.jsx)("ul",{id:"ulUsuarios",children:t.map((function(e,t){return Object(d.jsx)("li",{children:e.name},t)}))})]})},h=function(){return sessionStorage.getItem("token")||null},O=function(e,t){sessionStorage.setItem("token",e),sessionStorage.setItem("user",t)},x=function(e){var t=Object(s.useState)([]),n=Object(i.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){var e=b()("http://localhost:8080",{transports:["websocket"],auth:{"x-token":h()}});return e.on("usuarios-activos",(function(e){console.log({data:e}),a(e)})),function(){e.disconnect()}}),[]),Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("div",{className:"row mt-5",children:[Object(d.jsxs)("div",{className:"col-sm-6",children:[Object(d.jsx)("h3",{children:"Enviar mensaje"}),Object(d.jsx)("hr",{}),Object(d.jsx)("input",{type:"text",id:"txtUid",className:"form-control mb-2",placeholder:"uid",autoComplete:"off"}),Object(d.jsx)("input",{type:"text",id:"txtMensaje",className:"form-control mb-2",placeholder:"Mensaje",autoComplete:"off"}),Object(d.jsx)(m,{usuarios:c})]}),Object(d.jsxs)("div",{className:"col-sm-6",children:[Object(d.jsx)("h3",{children:"Chat completo"}),Object(d.jsx)("hr",{}),Object(d.jsx)("ul",{id:"ulMensajes"})]}),Object(d.jsxs)("div",{className:"col-sm-6",children:[Object(d.jsx)("h3",{children:"Chat privado"}),Object(d.jsx)("hr",{}),Object(d.jsx)("ul",{id:"ulMensajesPrivados"})]})]}),Object(d.jsx)("input",{type:"button",value:"Logout"})]})},f=function(){return Object(d.jsx)("div",{children:'Welcome to the Home Page"'})},p=function(e){var t=Object(s.useState)("test1@gmail.com"),n=Object(i.a)(t,2),c=n[0],a=n[1],o=Object(s.useState)("123456"),r=Object(i.a)(o,2),j=r[0],l=r[1],u=Object(s.useState)(null),b=Object(i.a)(u,2),m=b[0],h=b[1],x=Object(s.useState)(!1),f=Object(i.a)(x,2),p=f[0],g=f[1];return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Login"}),Object(d.jsx)("div",{children:Object(d.jsx)("input",{value:c,onChange:function(e){return a(e.target.value)},type:"text",placeholder:"username"})}),Object(d.jsx)("br",{}),Object(d.jsx)("div",{children:Object(d.jsx)("input",{value:j,onChange:function(e){return l(e.target.value)},type:"password",placeholder:"password"})}),Object(d.jsx)("br",{}),m&&Object(d.jsx)("div",{className:"error",children:m}),Object(d.jsx)("input",{type:"button",value:p?"Loading...":"Login",disabled:p,onClick:function(){if(""!==c&&""!==j){g(!0);var t={method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({email:c,password:j}),redirect:"follow"};fetch("/api/auth/login",t).then((function(e){return e.json()})).then((function(t){return t.errors?(h(t.errors[0].msg),void g(!1)):t.msg?(h(t.msg),void g(!1)):(O(t.token,JSON.stringify(t.user)),e.history.push("/join"),void g(!1))})).catch((function(e){g(!1),console.log(e),h("Something went wrong. Please try again later.")}))}else h("Completar campos")}})]})},g=(n(107),function(){var e=Object(s.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(d.jsx)("div",{className:"joinOuterContainer",children:Object(d.jsxs)("div",{className:"joinInnerContainer",children:[Object(d.jsx)("h1",{className:"heading",children:"Join"}),Object(d.jsx)("div",{children:Object(d.jsx)("input",{placeholder:"Room",onChange:function(e){return c(e.target.value)},className:"joinInput mt-20",type:"text"})}),Object(d.jsx)(j.b,{onClick:function(e){return n?null:e.preventDefault()},to:"/chat?room=".concat(n),children:Object(d.jsx)("button",{className:"button mt-20",type:"submit",children:"Unirse"})})]})})}),v=n(16),A=n(27),N=function(e){var t=e.component,n=Object(A.a)(e,["component"]);return Object(d.jsx)(l.b,Object(v.a)(Object(v.a)({},n),{},{render:function(e){return h()?Object(d.jsx)(t,Object(v.a)({},e)):Object(d.jsx)(l.a,{to:{pathName:"/login",state:{from:e.location}}})}}))},C=function(e){var t=e.component,n=Object(A.a)(e,["component"]);return Object(d.jsx)(l.b,Object(v.a)(Object(v.a)({},n),{},{render:function(e){return h()?Object(d.jsx)(l.a,{to:{pathName:"/dashboard"}}):Object(d.jsx)(t,Object(v.a)({},e))}}))},S=n(73),y=n(71),I=n.n(y),k=(n(123),function(e){var t=e.room;return Object(d.jsxs)("div",{className:"infoBar",children:[Object(d.jsxs)("div",{className:"leftInnerContainer",children:[Object(d.jsx)("img",{className:"onlineIcon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAAXNSR0IArs4c6QAAAExJREFUCB1jbPh/le3lx5tNDIwMcQwg8J9hkTi/eh0LWJCBoRwoAAPlQDEGJrhKmDCIBupmQuYjs5lAZiILgNlAMRaQRSAz4UZCLQcAIwYaiAejKoYAAAAASUVORK5CYII=",alt:"online icon"}),Object(d.jsx)("h3",{children:t})]}),Object(d.jsx)("div",{className:"rightInnerContainer",children:Object(d.jsx)("a",{href:"/",children:Object(d.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAHBJREFUGBmNkAEKwCAMA2VfGP2mrx3sOV2us6IymIXQGlNTW9zdhCqcZQm4dmelFUp+CZZa6sYpeUVIFyIixMqjCO51Wy5unQExuYSbSF5JASLqPsqRM21lOoWc89tagr3PSMgOiWlwnUeXWA/E78IfuAX270S3ydAAAAAASUVORK5CYII=",alt:"close icon"})})})]})}),w=(n(124),function(e){var t=e.message,n=e.setMessage,c=e.sendMessage;return Object(d.jsxs)("form",{className:"form",children:[Object(d.jsx)("input",{className:"input",type:"text",placeholder:"Type a message...",value:t,onChange:function(e){var t=e.target.value;return n(t)},onKeyPress:function(e){return"Enter"===e.key?c(e):null}}),Object(d.jsx)("button",{className:"sendButton",onClick:function(e){return c(e)},children:"Send"})]})}),E=n(72),M=n.n(E),U=(n(146),n(42)),B=n.n(U),J=function(e){var t=e.message,n=t.user,c=t.text,s=!1,a=e.name.trim().toLowerCase();return n===a&&(s=!0),s?Object(d.jsxs)("div",{className:"messageContainer justifyEnd",children:[Object(d.jsx)("p",{className:"sentText pr-10",children:a}),Object(d.jsx)("div",{className:"messageBox backgroundBlue",children:Object(d.jsx)("p",{className:"messageText colorWhite",children:B.a.emojify(c)})})]}):Object(d.jsxs)("div",{className:"messageContainer justifyStart",children:[Object(d.jsx)("div",{className:"messageBox backgroundLight",children:Object(d.jsx)("p",{className:"messageText colorDark",children:B.a.emojify(c)})}),Object(d.jsx)("p",{className:"sentText pl-10 ",children:n})]})},R=(n(147),function(e){var t=e.messages,n=e.name;return Object(d.jsx)(M.a,{className:"messages",children:t.map((function(e,t){return Object(d.jsx)("div",{children:Object(d.jsx)(J,{message:e,name:n})},t)}))})}),L=(n(148),function(e){var t=e.location,n=Object(s.useState)(""),a=Object(i.a)(n,2),o=a[0],r=a[1],j=Object(s.useState)(""),l=Object(i.a)(j,2),u=(l[0],l[1]),m=Object(s.useState)([]),O=Object(i.a)(m,2),x=O[0],f=O[1],p=function(){var e=sessionStorage.getItem("user");return e?JSON.parse(e):null}(),g=I.a.parse(t.search).room,v="https://chat-nmc.herokuapp.com/";Object(s.useEffect)((function(){return console.log(v),c=b()(v,{transports:["websocket","hola viejo"],auth:{"x-token":h(),data:{uid:p.uid,room:g}}}),function(){c.emit("disconnect_"),c.off()}}),[v,t.search]),Object(s.useEffect)((function(){setTimeout((function(){c.emit("join",{uid:p.uid,room:g},(function(e){e&&alert(e)}))}),1e3)}),[]),Object(s.useEffect)((function(){c.on("message",(function(e){f([].concat(Object(S.a)(x),[e]))})),c.on("roomData",(function(e){var t=e.users;u(t)}))}),[x]);return Object(d.jsx)("div",{className:"outerContainer",children:Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)(k,{room:g}),Object(d.jsx)(R,{messages:x,name:p.name}),Object(d.jsx)(w,{message:o,setMessage:r,sendMessage:function(e){e.preventDefault(),o&&c.emit("sendMessage",o,(function(){return r("")}))}})]})})});var T=function(){var e=Object(s.useState)(!0),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(s.useEffect)((function(){var e=h();e&&(console.log("Estoy por hacer el verifyToken contra la api"),fetch("/api/auth/verifyToken?token=".concat(e)).then((function(e){return e.json()})).then((function(e){O(e.token,e.user),c(!1)})).catch((function(e){sessionStorage.removeItem("token"),sessionStorage.removeItem("user"),c(!1),console.log(e)})))}),[]),n&&h()?Object(d.jsx)("div",{className:"content",children:"Checking Authentication..."}):Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)(j.a,{children:[Object(d.jsxs)("div",{className:"header",children:[Object(d.jsx)(j.c,{exact:!0,activeClassName:"active",to:"/",children:"Home"}),Object(d.jsx)(j.c,{activeClassName:"active",to:"/login",children:"Login"}),Object(d.jsxs)(j.c,{activeClassName:"active",to:"/join",children:["Join ",Object(d.jsx)("small",{children:"Access with token"})]}),Object(d.jsxs)(j.c,{activeClassName:"active",to:"/dashboard",children:["Dashboard ",Object(d.jsx)("small",{children:"Access with token"})]})]}),Object(d.jsx)("div",{className:"content",children:Object(d.jsxs)(l.d,{children:[Object(d.jsx)(l.b,{exact:!0,path:"/",component:f}),Object(d.jsx)(C,{exact:!0,path:"/login",component:p}),Object(d.jsx)(N,{exact:!0,path:"/join",component:g}),Object(d.jsx)(N,{exact:!0,path:"/chat",component:L}),Object(d.jsx)(N,{exact:!0,path:"/dashboard",component:x})]})})]})})};r.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(T,{})}),document.getElementById("root"))},78:function(e,t,n){}},[[149,1,2]]]);
//# sourceMappingURL=main.0cc93ed5.chunk.js.map